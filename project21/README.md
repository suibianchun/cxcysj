**Project21: Schnorr Bacth**

**实验原理图：**

![image](https://github.com/suibianchun/cxcysj/assets/138552183/5fabc8ea-04ff-490c-a3fd-f9471f0039db)

**相关介绍：**

Schnorr签名批量验证是一种用于验证多个Schnorr签名的技术。Schnorr签名是一种数字签名方案，具有高效性、简洁性和安全性的特点。批量验证允许同时验证多个签名，而不是逐个验证每个签名，从而提高了效率。

在Schnorr签名批量验证中，我们假设有一个签名集合，其中包含多个消息、相应的公钥和签名。批量验证的目标是验证签名集合中的所有签名的有效性，即验证它们是否由相应的私钥持有者生成。

Schnorr签名使用离散对数问题作为其安全基础。在批量验证中，我们使用聚合公钥和聚合签名的概念来验证签名集合。首先，将签名集合中的所有公钥聚合成一个聚合公钥，并将所有签名聚合成一个聚合签名。然后，通过验证聚合签名和聚合公钥之间的关系来验证签名集合中的所有签名。

**实现过程：**

首先定义了椭圆曲线的参数p、n和基点G，然后实现了椭圆曲线上的点加法运算函数EC_add，用于计算两个点在曲线上的和。接着定义了一些辅助函数，如计算n倍点的函数calculate_np、将点转换为字节数组的函数point_to_bytes和SHA-256哈希函数sha256。

接下来，代码实现了Schnorr签名算法的关键函数。Schnorr_Sign函数用于生成签名，它接收一个消息和私钥作为输入，并使用随机因子k计算出签名值R。然后根据R的y坐标的雅可比符号判断是否需要对k取反，再计算哈希值e，并返回R的x坐标和签名值s。

Schnorr_Verify函数用于验证Schnorr签名，它接收一个消息、公钥和签名作为输入。首先检查公钥是否在椭圆曲线上，然后解析出签名的r和s值。接着根据公钥、哈希值e和签名值s计算出临时点R，并判断R是否满足一定的条件，如果满足则返回True，否则返回False。

最后，代码实现了批量验证功能的Schnorr_Batch_Verify函数。它接收一个公钥列表、消息列表和签名列表作为输入，首先对每个签名进行验证，并计算出临时点Rs和Ps。然后将计算出的点与基点G的n倍点进行比较，如果相等，则表示所有签名都有效，返回True，否则返回False。

**运行结果：**

以验证三个签名为例：

![image](https://github.com/suibianchun/cxcysj/assets/138552183/f1829fea-c326-40cd-b0e6-8b241a4a9226)



